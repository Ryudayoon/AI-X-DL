# 현재의 음악 장르 분류기를 개선하는 모델


류다윤, 경영학부, <ryudy4977@naver.com>

최재훈, 경영학부, <bang8649@naver.com>

---


## I. Proposal
### A.	Motivation: Why are you doing this?
#### 오디오 데이터에 대한 연구의 부족
컴퓨팅 성능이 향상되고, 인공지능(AI), 머신러닝(ML), 딥러닝(DL)과 같은 기술이 발전하면서 최근 NLP(Natural Language Processing, 자연어 처리), CV(Computer Vision, 컴퓨터 비전)와 같이 텍스트와 이미지/영상 데이터를 분석, 처리하는 연구가 쏟아지고 있다. 하지만, 오디오/음성 데이터와 관련된 연구는 상대적으로 부족한 실정이다. 왜 그럴까?

#### 전처리가 까다로운 오디오 데이터의 특징
오디오 데이터는 매질(물체)의 진동을 통해 전달되는 일종의 아날로그 신호이다. 컴퓨터에게 이러한 아날로그 신호를 입력시키려면, 우리는 오디오 데이터를 디지털 신호로 변환해주어야 한다.
즉, [그림 1]과 같은 과정을 통해 아날로그 신호를 잘게 쪼개고, 각각의 값을 디지털화(숫자화) 해야 한다. 이러한 과정을 ‘샘플링(Sampling)'이라고 부른다. [그림 2]

![다운로드1](https://user-images.githubusercontent.com/97533303/171172021-a77e0ff2-c331-4f9e-89e2-65d996f1afda.png)
![다운로드2](https://user-images.githubusercontent.com/97533303/171172151-a7ca132e-0c0b-4baf-b0c2-2ddbaaa08f3d.jpeg)

하지만, 오디오 데이터가 지니는 2가지 근본적인 문제가 있다.
1. 첫 번째 문제 - 데이터의 크기가 매우 커진다
오디오 데이터를 샘플링 할 때, 1초 동안 n개의 샘플을 추출할 수 있다. 일반적으로. 오디오 데이터는 1초 동안 44100개의 샘플을 추출되며, 이를 샘플링 레이트(Sampling Rate, SR) 표현하면 44100Hz, 44.1kHz 이다.
30초 분량의 오디오 데이터를 분석한다고 예를 들면, 44100 * 30 = 1323000개의 샘플이 필요하다. 이처럼 디지털화된 오디오 데이터는 매우 큰 크기를 지니는데, 이는 컴퓨터가 데이터를 처리하는 것을 어렵게 만드는 요인이 된다.
우리는 ‘나이퀴스트 정리'를 통해 적절한 SR를 도출할 수 있다.

2. 두 번째 문제 - 오디오 데이터는 서로 다른 주파수가 결합되어 있는 형태로 나타난다.
오디오 데이터는 ‘시간 영역(x축)’과 ‘주파수 영역(y축)’으로 구성되며, [그림 3]에서 볼 수 있듯 오디오 데이터는 다양한 주파수로 구성된다. 이러한 오디오 데이터 형태는 ‘Feature Engineering(특징 추출)’을 어렵게 한다.

<img width="379" alt="스크린샷 2022-05-31 21 23 29" src="https://user-images.githubusercontent.com/97533303/171172368-f7c25e90-7445-43bd-89b4-2ea24b5c829a.png">

#### 정리
우리는 ‘고속 푸리에 변환'을 통해 오디오 데이터의  ‘시간 영역'을 ‘주파수 영역'으로 변환하고, 추가로 사람이 인식할 수 있도록 주파수를 mel-scale로 변환할 수 있다.
이러한 과정을 거치면, 우리는 Waveform 형태를 갖는 신호를 Mel-Spectrogram(멜-스펙트로그램) 이라는 형태로 변환할 수 있고, 음향 신호를 시간(x축), 주파수(y축), 진폭(z축)으로 살펴볼 수 있다.
이처럼, 오디오 데이터는 활용하기에 매우 까다롭다. 하지만 연산 속도가 점점 빨라지고 있으며 다양한 오디오 데이터를 위한 다양한 라이브러리가 존재하기 때문에, 오디오 데이터와 관련된 연구는 잠재적인 가능성이 많다.

오디오 데이터와 관련된 대표적인 분야로는 ‘음성 인식(Speech Recognition)', ‘오디오 분류(Audio Claasification)’, ‘오디오 캡셔닝(Audio Captioning)' 있다.
우리는 딥러닝을 통해 ‘오디오 분류' 문제를 해결하고자 하며, 주변에서 흔히 접할 수 있는 대표적인 오디오 데이터, 음악을 주제로 연구를 진행하고자 한다. 

#### 국내외 디지털 음원시장 현황 
ICT 기술의 발전으로 음악 시장이 다시 부활하고 있다.
디지털 음원 시장의 경우, 스트리밍 서비스가 등장하면서 꾸준한 상승세를 보이고 있고 앨범, 레코드와 같은 실물 음반 시장도 꾸준히 증가하고 있다.
특히 한국의 경우, K-Pop이 글로벌하게 확산되면서 음악 시장이 폭발적으로 성장하고 있다. 디지털 음원 시장의 경우, ‘멜론’, ‘지니’, ‘벅스’와 같은 국내 음원 스트리밍 서비스에서 많이 재생되던 한국 음원들이 글로벌 음원 스트리밍 서비스 업체인 ‘스포티파이', ‘유튜브 뮤직'에서도 높은 스트리밍 수를 기록하고 있으며, 실물 음반 시장의 경우, K-Pop 아티스트의 글로벌 팬덤들이 음반을 다량 소비하고 있다.

이는 한국의 디지털 콘텐츠 시장이 세계적으로 주목 받고 있는 시점에서, 한국의 음악 시장도 크게 성장하고 있다고 살펴볼 수 있다.
따라서, 우리는 한국 음악 시장을 주제로 프로젝트를 진행하고자 한다.

#### K-POP의 장르적 다양성
K-POP은 흔히 세대적인 관점에서 분석되곤 한다. H.O.T/젝스키스/S.E.S/핑클 등의 그룹이 활동하던 시절을 1세대, 동방신기/슈퍼주니어/빅뱅/원더걸스/소녀시대/카라 등의 그룹이 활동하던 시절을 2세대라고 하는 것처럼 말이다. 그렇게 2.5세대, 3세대, 3.5세대를 거쳐 2022년 현재에는 4세대 아이돌이라고 불리어지는 아이브/에스파/스테이씨 등이 활동하고 있다.

우선, 근본적으로 K-POP은 해외에서 유입된 다양한 장르들을 수용하면서 발전했다. 국내에서는 흔하지 않았던 장르를 1세대 케이팝 아티스트들이 가져왔고 이러한 경향은 점점 짙어져갔다. 그러던 중, 후크송을 내세운 2세대부터 케이팝이 특정 팬층이 향유하는 장르를 넘어 전 국민이 즐기는 장르로 도약했다. 이러한 영향으로 인해, 2.5세대에 들어서 케이팝은 많은 변화를 하기 시작했다.

흔히 2.5 세대 케이팝으로 분류되는, 2000년대 후반 데뷔 그룹부터 시작되는 세대의 케이팝은 사후적인 시선에서 보았을 때 현재의 케이팝의 근원이 되는 가장 가까운 기반으로서 자리하고 있다.
팬덤의 발전과 케이팝 시장 전반의 양적 성장 현장들이 2.5세대에 들어 더욱 확실하게 정착하기 시작했으며, 케이팝은 이전까지의 주 무대였던 국내와 동아시아 시장을 넘어 전 세계의 음악 시장으로 손을 뻗치기 시작했다.

이와 같은 성장세의 가속화에 따라 동시에 케이팝이라는 장르가 가지는 음악적 퀄리티와 그 특성은 발전을 거듭하게 되었고, 다양한 음악, 기획적 시도가 이루어졌다. 가령, 현재의 케이팝에서 활용되는 일렉트로닉 장르의 도입의 기저를 제시한 샤이니(SHINee), f(x)등의 그룹 역시 2.5 세대로 분류하고 있다.

이러한 케이팝의 장르적인 특징은 3세대를 시작으로 심화되었으며, 이는 케이팝만의 구별되는 특징이 되었다. 최근에 발매되는 케이팝에는 하나의 곡 내에서 다양한 장르가 맞물려 등장하는 경우도 자주 활용되곤 한다. 후렴 이후 갑작스러운 트랩 비트의 등장을 통해 랩 파트를 삽입하는 방식은 이제는 셀 수 없이 많은 사례가 존재하며, 강렬한 힙합, 혹은 일렉트로닉 비트와 부드러운 알앤비 풍의 멜로디가 겹쳐지며 그러한 낙차를 통해 역동성을 만드는 경우 역시 수많은 곡에서 재현되고 있다. 그렇게 3세대 이후, 특히 2010년대의 후반에 들어 더욱 거세지고 있는 케이팝의 역동성은 후크 송의 단순함을 탈피한다는 연유를 시작으로 그것만이 선사할 수 있는 재미를 함축하고 있다.

#### 이러한 다양성을 반영하지 못하는 현재의 음악 장르 분류기
하지만 이러한 K-Pop의 장르적 다양성에도 불구하고, 현재의 음악 장르 분류기는 이를 반영하지 못한다.
국내 최대 음원 스트리밍 사이트 ‘멜론’은 곡의 장르를 발라드, 댄스, 랩/힙합, R&B/소울, 인디음악, 록/메탈, 트로트, 포크/블루스 총 8가지로 분류하고 있으며, 대다수의 K-POP 곡들을 댄스, 랩-힙합 등으로 분류하고 있다. 하지만 앞서 언급했듯이  같은 댄스 장르라고 하더라도, K-POP은 하나의 곡 내에서도 매우 다양한 요소들이 결합되어 있다. 예를 들어, 방탄소년단의 대표곡인 ‘DNA’, ‘FAKE LOVE’ ,’IDOL’은 앨범 소개에 따르면 ‘일렉트로 팝', ‘이모 힙합’, ‘하우스 장르’로 살펴볼 수 있다. 하지만 현재 대부분의 음원 스트리밍 사이트들은 이를 ‘랩/힙합'이라는 단일한 카테고리로 분류하고 있다.

### B. What do you want to see at the end?
이렇듯 우리는 장르적인 다양성이 K-POP을 관통하는 특징임에도 불구하고, 기존의 분류 체제를 따르는 것이 현 시대를 잘 반영한다고 볼 수 있을지 의문이 들었다.
따라서 본 프로젝트는 기존의 광범위한 음악 장르 분류기를 현 시대에 맞춘 세분화된 분류기로 개선시키는 것을 목적으로 한다.

궁극적으로, 이를 통해 사용자가 자신이 원하는 음악을 더욱 디테일하게 찾을 수 있게 함을 목표로 한다.

#### 연구 문제 1
- 멜론 등에서 사용하는 것처럼, 기존의 음원 분류기를 재현한다
- 8개의 기존 분류 중 발라드, 댄스, 랩/힙합, R&B/소울 라는 4가지 장르가 유의미하다고 판단하였다.

#### 연구 문제 2
- 댄스 곡에 포함되어 있는 음악적인 특징을 감지하는 새로운 모델을 재현한다.
- 텍스트 마이닝을 통해 앨범 소개에 등장하는 음악적 특징을 도출해내고, 이 중 빈도가 높은 것을 종속 변수로 선정할 예정이다.

## II. Datasets 
[연구 문제 1]
2020년 1월부터 2021년 4월까지의 멜론 월간 차트 장르별 TOP100 음악 데이터와 앨범 소개를 사용한다.

[연구 문제 2]
2015년 1월부터 2021년 4월까지의 멜론 월간 댄스 차트 TOP100 음악 데이터와 앨범 소개 텍스트를 사용한다.
또한, 모델의 더욱 정확한 훈련을 위해 ‘LOOPERMAN’의 ‘Popular Music Loop Search Tags’ 데이터도 사용한다.

## III. Methodology 

### A. Explaining your choice of algorithms and features

#### i. 멜론 월간 차트 크롤링
먼저 멜론 월간 차트 장르별 TOP100에서 노래 제목, 앨범명, 가수의 정보를 크롤링한다.
셀레니움을 활용해서 홈페이지에 접근, 데이터를 크롤링했다. 코드는 레포지토리에 첨부해두었다.

<코드>

#### ii. 음원 추출
해당 데이터에서 각각의 노래 제목을 유튜브에서의 검색 키워드로 설정한다. 뮤직비디오의 경우, 음원 뿐만 아니라 여러 다양한 잡음(이걸 뭐라고 해야할지..)도 있기 때문에 흔히 유튜브에서 음원과 가사만 포함된 ‘lyrics' 형태의 데이터만을 추출한다. 그리고, 각각의 키워드를 검색한 후 나타나는 콘텐츠 제목과 url을 크롤링한다. ‘노래 제목+lyrics’ 형태의 검색에서 최상단에 있는 콘텐츠가 거의 대부분 우리가 찾고자 하는 순수하게 음원만 있는 데이터이기 때문에 가장 첫번째의 콘텐츠의 제목과 url만 추출한다. 그리고 YT-DLP를 통해 유튜브 영상을 다운로드하고 이를 wav로 포맷을 변경한다. 

<코드>

#### iii. 기존 음악 장르 분류기 구현

#### Feature
각 장르별 TOP100 음원의 wav 파일로 기존 음악 장르 분류기를 구현한다. 장르별로 크롤링했기 때문에 y값은 각 장르로 설정하면 된다. 예를 들어, 2022년 4월 멜론 월간 차트 발라드 TOP100 음악은 모두 '발라드'를 y값으로 한다. feature는 각 wav 파일을 Librosa를 통해 분석한 특징으로 한다. 

##### - Librosa 란?
Librosa는 음원 데이터를 분석하는 라이브러리다. Tempo(BPM), 음파가 양에서 음으로 또는 음에서 양으로 바뀌는 비율인 Zero Crossing Rate, 소리의 "무게 중심"이 어딘지를 알려주는 지표인 Spectral Centroid, 총 스펙트럴 에너지 중 낮은 주파수(85% 이하)에 얼마나 많이 집중되어 있는가를 알려주는 Spectral Rolloff 등의 다양한 기능들을 제공한다.

#### 분류 모델
XGBOOST를 사용하고자 한다....

####- XGBOOST 란?


#### iv. 개선된 음악 장르 분류기

댄스나 힙합의 경우에는 세분화된 장르가 많이 존재하기 때문에 이들의 분류를 더욱 구체화할 것이다. 먼저, 댄스에 해당하는 데이터만을 따로 뽑고 해당 곡들의 앨범 소개 글을 분석한다. 앨범 소개 글을 크롤링하고 TOP 100에 있는 곡의 소개만을 추출한다. 그리고 해당 소개 글을 n 개의 token으로 토크나이징한다. (장르의 명칭 특성상 최대 n=4로 하는 것이 적당하다고 판단했다.) 모든 앨범 소개에 n-gram을 적용하고 이들 중 가장 빈도수가 높은 5개의 세부 장르를 본 프로젝트의 새로운 분류 기준으로 정한다. 최종적으로 Librosa를 통해 분석한 각 음원별 특징을 feature로, 새로운 분류 기준을 y값으로 설정해 기존에 댄스로 분류되었던 곡들의 재분류한다. 

![image](https://user-images.githubusercontent.com/95442910/171098598-db17283f-cb99-40e7-99e8-0337dffef3ac.png)

예를 들어 레드벨벳의 'Feel My Rhythm' 의 경우에는 댄스 중에서도 트랩 비트를 가지고 있어 댄스-트랩으로 분류를 할 수 있을 것이다.
